name = "bifrost-slackbot"
main = "src/index.ts"
compatibility_date = "2025-01-01"
workers_dev = true

# KV namespace for Slack user permissions
[[kv_namespaces]]
binding = "SLACK_PERMISSIONS"
id = "e33dd19d7e6a43b0a6cf671b8e473cc9"

# D1 database for conversations (reuse analytics DB)
[[d1_databases]]
binding = "DB"
database_name = "bifrost-analytics"
database_id = "739159f2-a558-44a0-b26d-81ea30effc83"

[vars]
ENVIRONMENT = "production"
EDGE_ROUTER_URL = "https://henrychong.com"

# Required secrets (set via wrangler secret put):
# - SLACK_SIGNING_SECRET: Slack app signing secret
# - SLACK_BOT_TOKEN: Bot user OAuth token (xoxb-...)
# - ADMIN_API_KEY: Admin API key for edge router

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true

[observability.traces]
enabled = true
head_sampling_rate = 1

[env.dev]
name = "bifrost-slackbot-dev"
workers_dev = true

[env.dev.vars]
ENVIRONMENT = "development"
